{"ast":null,"code":"import { each, get } from '@antv/util';\nimport { doAnimate } from '../animate';\nimport { getReplaceAttrs } from '../util/graphics';\n/**\n * @desc 更新 label (目前没有根据 id 索引，还是会存在一点小问题的，只能根据 idx 索引)\n * @done shape 属性更新\n * @done shape delete\n * @done shape append\n *\n * @param fromShape old labelShape\n * @param toShape new labelShape\n * @param cfg\n */\nexport function updateLabel(fromShape, toShape, cfg) {\n  var data = cfg.data,\n    origin = cfg.origin,\n    animateCfg = cfg.animateCfg,\n    coordinate = cfg.coordinate;\n  var updateAnimateCfg = get(animateCfg, 'update');\n  fromShape.set('data', data);\n  fromShape.set('origin', origin);\n  fromShape.set('animateCfg', animateCfg);\n  fromShape.set('coordinate', coordinate);\n  fromShape.set('visible', toShape.get('visible'));\n  (fromShape.getChildren() || []).forEach(function (fromChild, idx) {\n    var toChild = toShape.getChildByIndex(idx);\n    if (!toChild) {\n      fromShape.removeChild(fromChild);\n      fromChild.remove(true);\n    } else {\n      fromChild.set('data', data);\n      fromChild.set('origin', origin);\n      fromChild.set('animateCfg', animateCfg);\n      fromChild.set('coordinate', coordinate);\n      var newAttrs = getReplaceAttrs(fromChild, toChild);\n      if (updateAnimateCfg) {\n        doAnimate(fromChild, updateAnimateCfg, {\n          toAttrs: newAttrs,\n          coordinate: coordinate\n        });\n      } else {\n        fromChild.attr(newAttrs);\n      }\n      if (toChild.isGroup()) {\n        updateLabel(fromChild, toChild, cfg);\n      }\n    }\n  });\n  // append\n  each(toShape.getChildren(), function (child, idx) {\n    if (idx >= fromShape.getCount()) {\n      if (!child.destroyed) {\n        fromShape.add(child);\n      }\n    }\n  });\n}","map":null,"metadata":{},"sourceType":"module"}