{"ast":null,"code":"import { __assign, __spreadArrays } from \"tslib\";\nimport { Util } from '@antv/g2';\nimport { get } from '@antv/util';\nimport { deepAssign } from '../utils';\nimport { getCanvasPattern } from '../utils/pattern';\n/**\n * Pattern é€šé“ï¼Œå¤„ç†å›¾æ¡ˆå¡«å……\n * ğŸš€ ç›®å‰æ”¯æŒå›¾è¡¨ç±»å‹ï¼šé¥¼å›¾ã€æŸ±çŠ¶å›¾ã€æ¡å½¢å›¾ã€ç‰çå›¾ç­‰ï¼ˆä¸æ”¯æŒåœ¨å¤š view å›¾è¡¨ä¸­ï¼Œåç»­æŒ‰éœ€æ‰©å±•ï¼‰\n *\n * @param key key of style property\n * @returns\n */\nexport function pattern(key) {\n  var _this = this;\n  return function (params) {\n    var _a;\n    var options = params.options,\n      chart = params.chart;\n    var patternOption = options.pattern;\n    // æ²¡æœ‰ pattern é…ç½®ï¼Œåˆ™ç›´æ¥è¿”å›\n    if (!patternOption) {\n      return params;\n    }\n    /** ~~~~~~~ è¿›è¡Œè´´å›¾å›¾æ¡ˆå¤„ç† ~~~~~~~ */\n    var style = function style(datum) {\n      var _a, _b, _c;\n      var args = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n      var defaultColor = chart.getTheme().defaultColor;\n      var color = defaultColor;\n      var colorAttribute = (_b = (_a = chart.geometries) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.getAttribute('color');\n      if (colorAttribute) {\n        var colorField = colorAttribute.getFields()[0];\n        var seriesValue = get(datum, colorField);\n        color = Util.getMappingValue(colorAttribute, seriesValue, ((_c = colorAttribute.values) === null || _c === void 0 ? void 0 : _c[0]) || defaultColor);\n      }\n      var pattern = patternOption;\n      // 1. å¦‚æœ patternOption æ˜¯ä¸€ä¸ªå›è°ƒï¼Œåˆ™è·å–å›è°ƒç»“æœã€‚`(datum: Datum, color: string) => CanvasPattern`\n      if (typeof patternOption === 'function') {\n        pattern = patternOption.call(_this, datum, color);\n      }\n      // 2. å¦‚æœ pattern ä¸æ˜¯ CanvasPatternï¼Œåˆ™è¿›ä¸€æ­¥å¤„ç†ï¼Œå¦åˆ™ç›´æ¥èµ‹äºˆç»™ fill\n      if (pattern instanceof CanvasPattern === false) {\n        // é€šè¿‡ createPattern(PatternStyle) è½¬æ¢ä¸º CanvasPattern\n        pattern = getCanvasPattern(deepAssign({}, {\n          cfg: {\n            backgroundColor: color\n          }\n        }, pattern));\n      }\n      var styleOption = options[key];\n      return __assign(__assign({}, typeof styleOption === 'function' ? styleOption.call.apply(styleOption, __spreadArrays([_this, datum], args)) : styleOption || {}), {\n        fill: pattern || color\n      });\n    };\n    return deepAssign({}, params, {\n      options: (_a = {}, _a[key] = style, _a)\n    });\n  };\n}","map":null,"metadata":{},"sourceType":"module"}