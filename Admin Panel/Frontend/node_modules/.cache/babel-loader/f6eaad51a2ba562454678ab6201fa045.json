{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { Event, VIEW_LIFE_CIRCLE } from '@antv/g2';\nimport { Plot } from '../../core/plot';\nimport { processIllegalData } from '../../utils';\nimport { adaptor, pieAnnotation } from './adaptor';\nimport { DEFAULT_OPTIONS } from './contants';\nimport './interactions';\nimport { isAllZero } from './utils';\nvar Pie = /** @class */function (_super) {\n  __extends(Pie, _super);\n  function Pie() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /** 图表类型 */\n    _this.type = 'pie';\n    return _this;\n  }\n  /**\n   * 获取 饼图 默认配置项\n   * 供外部使用\n   */\n  Pie.getDefaultOptions = function () {\n    return DEFAULT_OPTIONS;\n  };\n  /**\n   * 更新数据\n   * @param data\n   */\n  Pie.prototype.changeData = function (data) {\n    this.chart.emit(VIEW_LIFE_CIRCLE.BEFORE_CHANGE_DATA, Event.fromData(this.chart, VIEW_LIFE_CIRCLE.BEFORE_CHANGE_DATA, null));\n    var prevOptions = this.options;\n    var angleField = this.options.angleField;\n    var prevData = processIllegalData(prevOptions.data, angleField);\n    var curData = processIllegalData(data, angleField);\n    // 如果上一次或当前数据全为 0，则重新渲染\n    if (isAllZero(prevData, angleField) || isAllZero(curData, angleField)) {\n      this.update({\n        data: data\n      });\n    } else {\n      this.updateOption({\n        data: data\n      });\n      this.chart.data(curData);\n      // todo 后续让 G2 层在 afterrender 之后，来重绘 annotations\n      pieAnnotation({\n        chart: this.chart,\n        options: this.options\n      });\n      this.chart.render(true);\n    }\n    this.chart.emit(VIEW_LIFE_CIRCLE.AFTER_CHANGE_DATA, Event.fromData(this.chart, VIEW_LIFE_CIRCLE.AFTER_CHANGE_DATA, null));\n  };\n  /**\n   * 获取 饼图 默认配置项, 供 base 获取\n   */\n  Pie.prototype.getDefaultOptions = function () {\n    return Pie.getDefaultOptions();\n  };\n  /**\n   * 获取 饼图 的适配器\n   */\n  Pie.prototype.getSchemaAdaptor = function () {\n    return adaptor;\n  };\n  return Pie;\n}(Plot);\nexport { Pie };","map":null,"metadata":{},"sourceType":"module"}