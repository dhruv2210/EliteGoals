{"ast":null,"code":"import { __spreadArrays } from \"tslib\";\nimport { get } from '@antv/util';\nimport { animation, annotation, interaction as commonInteraction, legend, theme, tooltip } from '../../adaptor/common';\nimport { polygon as basePolygon } from '../../adaptor/geometries/polygon';\nimport { pattern } from '../../adaptor/pattern';\nimport { deepAssign, flow } from '../../utils';\nimport { getAdjustAppendPadding } from '../../utils/padding';\nimport { enableDrillInteraction, findInteraction, transformData } from './utils';\n/**\n * è·å–é»˜è®¤ option\n * @param params\n */\nfunction defaultOptions(params) {\n  var options = params.options;\n  var colorField = options.colorField;\n  return deepAssign({\n    options: {\n      rawFields: ['value'],\n      tooltip: {\n        fields: ['name', 'value', colorField, 'path'],\n        formatter: function formatter(data) {\n          return {\n            name: data.name,\n            value: data.value\n          };\n        }\n      }\n    }\n  }, params);\n}\n/**\n * å­—æ®µ\n * @param params\n */\nfunction geometry(params) {\n  var chart = params.chart,\n    options = params.options;\n  var color = options.color,\n    colorField = options.colorField,\n    rectStyle = options.rectStyle,\n    hierarchyConfig = options.hierarchyConfig,\n    rawFields = options.rawFields;\n  var data = transformData({\n    data: options.data,\n    colorField: options.colorField,\n    enableDrillDown: enableDrillInteraction(options),\n    hierarchyConfig: hierarchyConfig\n  });\n  chart.data(data);\n  // geometry\n  basePolygon(deepAssign({}, params, {\n    options: {\n      xField: 'x',\n      yField: 'y',\n      seriesField: colorField,\n      rawFields: rawFields,\n      polygon: {\n        color: color,\n        style: rectStyle\n      }\n    }\n  }));\n  // åšä¸€ä¸ªåè½¬ï¼Œè¿™æ ·é…åˆæ’åºï¼Œå¯ä»¥å°†æœ€å¤§å€¼æ”¾åˆ°å·¦ä¸Šè§’ï¼Œæœ€å°å€¼æ”¾åˆ°å³ä¸‹è§’\n  chart.coordinate().reflect('y');\n  return params;\n}\n/**\n * åæ ‡è½´\n * @param params\n */\nfunction axis(params) {\n  var chart = params.chart;\n  chart.axis(false);\n  return params;\n}\nfunction adaptorInteraction(options) {\n  var drilldown = options.drilldown,\n    _a = options.interactions,\n    interactions = _a === void 0 ? [] : _a;\n  var enableDrillDown = enableDrillInteraction(options);\n  if (enableDrillDown) {\n    return deepAssign({}, options, {\n      interactions: __spreadArrays(interactions, [{\n        type: 'drill-down',\n        // ğŸš“ è¿™ä¸æ˜¯ä¸€ä¸ªè§„èŒƒçš„ APIï¼Œåç»­ä¼šå˜æ›´ã€‚æ…é‡å‚è€ƒ\n        cfg: {\n          drillDownConfig: drilldown,\n          transformData: transformData\n        }\n      }])\n    });\n  }\n  return options;\n}\n/**\n * Interaction é…ç½®\n * @param params\n */\nexport function interaction(params) {\n  var chart = params.chart,\n    options = params.options;\n  var interactions = options.interactions,\n    drilldown = options.drilldown;\n  commonInteraction({\n    chart: chart,\n    options: adaptorInteraction(options)\n  });\n  // é€‚é… view-zoom\n  var viewZoomInteraction = findInteraction(interactions, 'view-zoom');\n  if (viewZoomInteraction) {\n    // å¼€å¯ç¼©æ”¾ interaction åï¼Œåˆ™é˜»æ­¢é»˜è®¤æ»šåŠ¨äº‹ä»¶ï¼Œé¿å…æ•´ä¸ªçª—å£çš„æ»šåŠ¨\n    if (viewZoomInteraction.enable !== false) {\n      chart.getCanvas().on('mousewheel', function (ev) {\n        ev.preventDefault();\n      });\n    } else {\n      // æ‰‹åŠ¨å…³é—­åï¼Œæ¸…é™¤ã€‚ä»…å¯¹å£°æ˜ viewZoomInteraction çš„æ¸…é™¤ã€‚\n      chart.getCanvas().off('mousewheel');\n    }\n  }\n  // é€‚åº”ä¸‹é’»äº¤äº’é¢åŒ…å±‘\n  var enableDrillDown = enableDrillInteraction(options);\n  if (enableDrillDown) {\n    // ä¸ºé¢åŒ…å±‘åœ¨åº•éƒ¨ç•™å‡º 25px çš„ç©ºé—´\n    chart.appendPadding = getAdjustAppendPadding(chart.appendPadding, get(drilldown, ['breadCrumb', 'position']));\n  }\n  return params;\n}\n/**\n * çŸ©å½¢æ ‘å›¾\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n  return flow(defaultOptions, theme, pattern('rectStyle'), geometry, axis, legend, tooltip, interaction, animation, annotation())(params);\n}","map":null,"metadata":{},"sourceType":"module"}