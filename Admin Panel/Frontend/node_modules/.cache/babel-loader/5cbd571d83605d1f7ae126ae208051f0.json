{"ast":null,"code":"import { setTransform, setClip } from './svg';\nimport { sortDom, moveTo } from './dom';\nexport function drawChildren(context, children) {\n  children.forEach(function (child) {\n    child.draw(context);\n  });\n}\n/**\n * 更新元素，包括 group 和 shape\n * @param {IElement} element       SVG 元素\n * @param {ChangeType} changeType  更新类型\n */\nexport function refreshElement(element, changeType) {\n  // 对于还没有挂载到画布下的元素，canvas 可能为空\n  var canvas = element.get('canvas');\n  // 只有挂载到画布下，才对元素进行实际渲染\n  if (canvas && canvas.get('autoDraw')) {\n    var context = canvas.get('context');\n    var parent_1 = element.getParent();\n    var parentChildren = parent_1 ? parent_1.getChildren() : [canvas];\n    var el = element.get('el');\n    if (changeType === 'remove') {\n      var isClipShape = element.get('isClipShape');\n      // 对于 clip，不仅需要将 clipShape 对于的 SVG 元素删除，还需要将上层的 clipPath 元素也删除\n      if (isClipShape) {\n        var clipPathEl = el && el.parentNode;\n        var defsEl = clipPathEl && clipPathEl.parentNode;\n        if (clipPathEl && defsEl) {\n          defsEl.removeChild(clipPathEl);\n        }\n      } else if (el && el.parentNode) {\n        el.parentNode.removeChild(el);\n      }\n    } else if (changeType === 'show') {\n      el.setAttribute('visibility', 'visible');\n    } else if (changeType === 'hide') {\n      el.setAttribute('visibility', 'hidden');\n    } else if (changeType === 'zIndex') {\n      moveTo(el, parentChildren.indexOf(element));\n    } else if (changeType === 'sort') {\n      var children_1 = element.get('children');\n      if (children_1 && children_1.length) {\n        sortDom(element, function (a, b) {\n          return children_1.indexOf(a) - children_1.indexOf(b) ? 1 : 0;\n        });\n      }\n    } else if (changeType === 'clear') {\n      // el maybe null for group\n      if (el) {\n        el.innerHTML = '';\n      }\n    } else if (changeType === 'matrix') {\n      setTransform(element);\n    } else if (changeType === 'clip') {\n      setClip(element, context);\n    } else if (changeType === 'attr') {\n      // 已在 afterAttrsChange 进行了处理，此处 do nothing\n    } else if (changeType === 'add') {\n      element.draw(context);\n    }\n  }\n}","map":null,"metadata":{},"sourceType":"module"}