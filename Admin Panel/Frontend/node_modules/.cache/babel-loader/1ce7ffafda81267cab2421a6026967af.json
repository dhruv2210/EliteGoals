{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport GroupComponent from '../abstract/group-component';\nimport { createBBox, formatPadding } from '../util/util';\nvar LegendBase = /** @class */function (_super) {\n  __extends(LegendBase, _super);\n  function LegendBase() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  LegendBase.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n    return __assign(__assign({}, cfg), {\n      name: 'legend',\n      /**\n       * 布局方式： horizontal，vertical\n       * @type {String}\n       */\n      layout: 'horizontal',\n      locationType: 'point',\n      x: 0,\n      y: 0,\n      offsetX: 0,\n      offsetY: 0,\n      title: null,\n      background: null\n    });\n  };\n  LegendBase.prototype.getLayoutBBox = function () {\n    var bbox = _super.prototype.getLayoutBBox.call(this);\n    var maxWidth = this.get('maxWidth');\n    var maxHeight = this.get('maxHeight');\n    var width = bbox.width,\n      height = bbox.height;\n    if (maxWidth) {\n      width = Math.min(width, maxWidth);\n    }\n    if (maxHeight) {\n      height = Math.min(height, maxHeight);\n    }\n    return createBBox(bbox.minX, bbox.minY, width, height);\n  };\n  LegendBase.prototype.setLocation = function (cfg) {\n    this.set('x', cfg.x);\n    this.set('y', cfg.y);\n    this.resetLocation();\n  };\n  LegendBase.prototype.resetLocation = function () {\n    var x = this.get('x');\n    var y = this.get('y');\n    var offsetX = this.get('offsetX');\n    var offsetY = this.get('offsetY');\n    this.moveElementTo(this.get('group'), {\n      x: x + offsetX,\n      y: y + offsetY\n    });\n  };\n  LegendBase.prototype.applyOffset = function () {\n    this.resetLocation();\n  };\n  // 获取当前绘制的点\n  LegendBase.prototype.getDrawPoint = function () {\n    return this.get('currentPoint');\n  };\n  LegendBase.prototype.setDrawPoint = function (point) {\n    return this.set('currentPoint', point);\n  };\n  // 复写父类定义的绘制方法\n  LegendBase.prototype.renderInner = function (group) {\n    this.resetDraw();\n    if (this.get('title')) {\n      this.drawTitle(group);\n    }\n    this.drawLegendContent(group);\n    if (this.get('background')) {\n      this.drawBackground(group);\n    }\n    // this.resetLocation(); // 在顶层已经在处理偏移时一起处理了\n  };\n  // 绘制背景\n  LegendBase.prototype.drawBackground = function (group) {\n    var background = this.get('background');\n    var bbox = group.getBBox();\n    var padding = formatPadding(background.padding);\n    var attrs = __assign({\n      // 背景从 (0,0) 开始绘制\n      x: 0,\n      y: 0,\n      width: bbox.width + padding[1] + padding[3],\n      height: bbox.height + padding[0] + padding[2]\n    }, background.style);\n    var backgroundShape = this.addShape(group, {\n      type: 'rect',\n      id: this.getElementId('background'),\n      name: 'legend-background',\n      attrs: attrs\n    });\n    backgroundShape.toBack();\n  };\n  // 绘制标题，标题在图例项的上面\n  LegendBase.prototype.drawTitle = function (group) {\n    var currentPoint = this.get('currentPoint');\n    var titleCfg = this.get('title');\n    var spacing = titleCfg.spacing,\n      style = titleCfg.style,\n      text = titleCfg.text;\n    var shape = this.addShape(group, {\n      type: 'text',\n      id: this.getElementId('title'),\n      name: 'legend-title',\n      attrs: __assign({\n        text: text,\n        x: currentPoint.x,\n        y: currentPoint.y\n      }, style)\n    });\n    var bbox = shape.getBBox();\n    // 标题单独在一行\n    this.set('currentPoint', {\n      x: currentPoint.x,\n      y: bbox.maxY + spacing\n    });\n  };\n  // 重置绘制时开始的位置，如果绘制边框，考虑边框的 padding\n  LegendBase.prototype.resetDraw = function () {\n    var background = this.get('background');\n    var currentPoint = {\n      x: 0,\n      y: 0\n    };\n    if (background) {\n      var padding = formatPadding(background.padding);\n      currentPoint.x = padding[3]; // 左边 padding\n      currentPoint.y = padding[0]; // 上面 padding\n    }\n\n    this.set('currentPoint', currentPoint); // 设置绘制的初始位置\n  };\n\n  return LegendBase;\n}(GroupComponent);\nexport default LegendBase;","map":null,"metadata":{},"sourceType":"module"}