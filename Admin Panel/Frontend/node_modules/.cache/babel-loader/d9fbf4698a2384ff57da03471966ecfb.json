{"ast":null,"code":"import { __spreadArrays } from \"tslib\";\nimport { each, isNil, isObject } from '@antv/util';\nimport { AXIS_META_CONFIG_KEYS } from '../constant';\nimport { addViewAnimation, deepAssign, pick } from '../utils';\n/**\n * 通用 legend 配置, 适用于带 colorField 或 seriesField 的图表\n * @param params\n */\nexport function legend(params) {\n  var chart = params.chart,\n    options = params.options;\n  var legend = options.legend,\n    colorField = options.colorField,\n    seriesField = options.seriesField;\n  if (legend === false) {\n    chart.legend(false);\n  } else if (colorField || seriesField) {\n    chart.legend(colorField || seriesField, legend);\n  }\n  return params;\n}\n/**\n * 通用 tooltip 配置\n * @param params\n */\nexport function tooltip(params) {\n  var chart = params.chart,\n    options = params.options;\n  var tooltip = options.tooltip;\n  if (tooltip !== undefined) {\n    chart.tooltip(tooltip);\n  }\n  return params;\n}\n/**\n * Interaction 配置\n * @param params\n */\nexport function interaction(params) {\n  var chart = params.chart,\n    options = params.options;\n  var interactions = options.interactions;\n  each(interactions, function (i) {\n    if (i.enable === false) {\n      chart.removeInteraction(i.type);\n    } else {\n      chart.interaction(i.type, i.cfg || {});\n    }\n  });\n  return params;\n}\n/**\n * 动画\n * @param params\n */\nexport function animation(params) {\n  var chart = params.chart,\n    options = params.options;\n  var animation = options.animation;\n  // 所有的 Geometry 都使用同一动画（各个图形如有区别，自行覆盖）\n  addViewAnimation(chart, animation);\n  return params;\n}\n/**\n * 设置全局主题配置\n * @param params\n */\nexport function theme(params) {\n  var chart = params.chart,\n    options = params.options;\n  var theme = options.theme;\n  // 存在主题才设置主题\n  if (theme) {\n    chart.theme(theme);\n  }\n  return params;\n}\n/**\n * 状态 state 配置\n * @param params\n */\nexport function state(params) {\n  var chart = params.chart,\n    options = params.options;\n  var state = options.state;\n  if (state) {\n    each(chart.geometries, function (geometry) {\n      geometry.state(state);\n    });\n  }\n  return params;\n}\n/**\n * 处理缩略轴的 adaptor\n * @param params\n */\nexport function slider(params) {\n  var chart = params.chart,\n    options = params.options;\n  var slider = options.slider;\n  chart.option('slider', slider);\n  return params;\n}\n/**\n * 处理缩略轴的 adaptor\n * @param params\n */\nexport function scrollbar(params) {\n  var chart = params.chart,\n    options = params.options;\n  var scrollbar = options.scrollbar;\n  chart.option('scrollbar', scrollbar);\n  return params;\n}\n/**\n * scale 的 adaptor\n * @param axes\n */\nexport function scale(axes, meta) {\n  return function (params) {\n    var chart = params.chart,\n      options = params.options;\n    // 1. 轴配置中的 scale 信息\n    var scales = {};\n    each(axes, function (axis, field) {\n      scales[field] = pick(axis, AXIS_META_CONFIG_KEYS);\n    });\n    // 2. meta 直接是 scale 的信息\n    scales = deepAssign({}, meta, options.meta, scales);\n    chart.scale(scales);\n    return params;\n  };\n}\n/**\n * annotation 配置\n * @param params\n */\nexport function annotation(annotationOptions) {\n  return function (params) {\n    var chart = params.chart,\n      options = params.options;\n    var annotationController = chart.getController('annotation');\n    /** 自定义 annotation */\n    each(__spreadArrays(options.annotations || [], annotationOptions || []), function (annotationOption) {\n      // @ts-ignore\n      annotationController.annotation(annotationOption);\n    });\n    return params;\n  };\n}\n/**\n * 自动设置 limitInPlot\n * @param params\n */\nexport function limitInPlot(params) {\n  var chart = params.chart,\n    options = params.options;\n  var yAxis = options.yAxis,\n    limitInPlot = options.limitInPlot;\n  var value = limitInPlot;\n  // 用户没有设置 limitInPlot，则自动根据 yAxis 是否有 min/max 来设置 limitInPlot\n  if (isObject(yAxis) && isNil(limitInPlot)) {\n    if (Object.values(pick(yAxis, ['min', 'max', 'minLimit', 'maxLimit'])).some(function (value) {\n      return !isNil(value);\n    })) {\n      value = true;\n    } else {\n      value = false;\n    }\n  }\n  chart.limitInPlot = value;\n  return params;\n}\n/**\n * 坐标系转换\n */\nexport function transformations(coordinateType) {\n  if (coordinateType === void 0) {\n    coordinateType = 'rect';\n  }\n  return function (params) {\n    var chart = params.chart,\n      options = params.options;\n    var coordinate = options.coordinate;\n    var actions = Array.from(coordinate || []).map(function (cfg) {\n      if (cfg.type === 'reflectX') return ['reflect', 'x'];\n      if (cfg.type === 'reflectY') return ['reflect', 'y'];\n      if (cfg.type === 'transpose') return ['transpose'];\n      return null;\n    }).filter(function (d) {\n      return !!d;\n    });\n    if (actions.length !== 0) {\n      chart.coordinate({\n        type: coordinateType,\n        actions: actions\n      });\n    }\n    return params;\n  };\n}\nexport { pattern } from './pattern';","map":null,"metadata":{},"sourceType":"module"}