{"version":3,"sources":["../../src/webgpu/constants.ts"],"names":["gl","WebGPUConstants","primitiveMap","POINTS","PrimitiveTopology","PointList","LINES","LineList","LINE_LOOP","LINE_STRIP","LineStrip","TRIANGLES","TriangleList","TRIANGLE_FAN","TRIANGLE_STRIP","TriangleStrip","depthFuncMap","NEVER","CompareFunction","Never","ALWAYS","Always","LESS","Less","LEQUAL","LessEqual","GREATER","Greater","GEQUAL","GreaterEqual","EQUAL","Equal","NOTEQUAL","NotEqual","blendEquationMap","FUNC_ADD","BlendOperation","Add","MIN_EXT","Min","MAX_EXT","Max","FUNC_SUBTRACT","Subtract","FUNC_REVERSE_SUBTRACT","ReverseSubtract","blendFuncMap","ZERO","BlendFactor","Zero","ONE","One","SRC_COLOR","SrcColor","ONE_MINUS_SRC_COLOR","OneMinusSrcColor","SRC_ALPHA","SrcAlpha","ONE_MINUS_SRC_ALPHA","OneMinusSrcAlpha","DST_COLOR","DstColor","ONE_MINUS_DST_COLOR","OneMinusDstColor","DST_ALPHA","DstAlpha","ONE_MINUS_DST_ALPHA","OneMinusDstAlpha","CONSTANT_COLOR","BlendColor","ONE_MINUS_CONSTANT_COLOR","OneMinusBlendColor","SRC_ALPHA_SATURATE","SrcAlphaSaturated","formatMap","ALPHA","RGBA","DEPTH_COMPONENT","DEPTH_STENCIL","filterMap","NEAREST","LINEAR","wrapModeMap","REPEAT","CLAMP_TO_EDGE","MIRRORED_REPEAT","getCullMode","cull","enable","CullMode","None","face","FRONT","Front","Back","getDepthStencilStateDescriptor","depth","stencil","stencilFrontBack","compare","depthFailOp","StencilOperation","Keep","failOp","passOp","depthWriteEnabled","depthCompare","func","format","TextureFormat","Depth24PlusStencil8","stencilFront","stencilBack","stencilReadMask","stencilWriteMask","getColorStateDescriptors","swapChainFormat","blend","alphaBlend","srcFactor","srcAlpha","dstFactor","dstAlpha","operation","equation","alpha","colorBlend","srcRGB","dstRGB","rgb","writeMask","ColorWrite","All"],"mappings":"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","sourcesContent":["import { gl, IModelInitializationOptions } from '@antv/g-webgpu-core';\nimport * as WebGPUConstants from '@webgpu/types/dist/constants';\n\n// WebGPU 不支持 LINE_LOOP & TRIANGLE_FAN\nexport const primitiveMap: {\n  [key: string]:\n    | WebGPUConstants.PrimitiveTopology.PointList\n    | WebGPUConstants.PrimitiveTopology.LineList\n    | WebGPUConstants.PrimitiveTopology.LineStrip\n    | WebGPUConstants.PrimitiveTopology.TriangleList\n    | WebGPUConstants.PrimitiveTopology.TriangleStrip;\n} = {\n  [gl.POINTS]: WebGPUConstants.PrimitiveTopology.PointList,\n  [gl.LINES]: WebGPUConstants.PrimitiveTopology.LineList,\n  [gl.LINE_LOOP]: WebGPUConstants.PrimitiveTopology.LineList,\n  [gl.LINE_STRIP]: WebGPUConstants.PrimitiveTopology.LineStrip,\n  [gl.TRIANGLES]: WebGPUConstants.PrimitiveTopology.TriangleList,\n  [gl.TRIANGLE_FAN]: WebGPUConstants.PrimitiveTopology.TriangleList,\n  [gl.TRIANGLE_STRIP]: WebGPUConstants.PrimitiveTopology.TriangleStrip,\n};\n\nexport const depthFuncMap: {\n  [key: string]:\n    | WebGPUConstants.CompareFunction.Never\n    | WebGPUConstants.CompareFunction.Always\n    | WebGPUConstants.CompareFunction.Less\n    | WebGPUConstants.CompareFunction.LessEqual\n    | WebGPUConstants.CompareFunction.Greater\n    | WebGPUConstants.CompareFunction.GreaterEqual\n    | WebGPUConstants.CompareFunction.Equal\n    | WebGPUConstants.CompareFunction.NotEqual;\n} = {\n  [gl.NEVER]: WebGPUConstants.CompareFunction.Never,\n  [gl.ALWAYS]: WebGPUConstants.CompareFunction.Always,\n  [gl.LESS]: WebGPUConstants.CompareFunction.Less,\n  [gl.LEQUAL]: WebGPUConstants.CompareFunction.LessEqual,\n  [gl.GREATER]: WebGPUConstants.CompareFunction.Greater,\n  [gl.GEQUAL]: WebGPUConstants.CompareFunction.GreaterEqual,\n  [gl.EQUAL]: WebGPUConstants.CompareFunction.Equal,\n  [gl.NOTEQUAL]: WebGPUConstants.CompareFunction.NotEqual,\n};\n\nexport const blendEquationMap: {\n  [key: string]:\n    | WebGPUConstants.BlendOperation.Add\n    | WebGPUConstants.BlendOperation.Min\n    | WebGPUConstants.BlendOperation.Max\n    | WebGPUConstants.BlendOperation.Subtract\n    | WebGPUConstants.BlendOperation.ReverseSubtract;\n} = {\n  [gl.FUNC_ADD]: WebGPUConstants.BlendOperation.Add,\n  [gl.MIN_EXT]: WebGPUConstants.BlendOperation.Min,\n  [gl.MAX_EXT]: WebGPUConstants.BlendOperation.Max,\n  [gl.FUNC_SUBTRACT]: WebGPUConstants.BlendOperation.Subtract,\n  [gl.FUNC_REVERSE_SUBTRACT]: WebGPUConstants.BlendOperation.ReverseSubtract,\n};\n\n// @see https://gpuweb.github.io/gpuweb/#blend-state\n// 不支持 'constant alpha' 和 'one minus constant alpha'\nexport const blendFuncMap: {\n  [key: string]:\n    | WebGPUConstants.BlendFactor.Zero\n    | WebGPUConstants.BlendFactor.One\n    | WebGPUConstants.BlendFactor.SrcColor\n    | WebGPUConstants.BlendFactor.OneMinusSrcColor\n    | WebGPUConstants.BlendFactor.SrcAlpha\n    | WebGPUConstants.BlendFactor.OneMinusSrcAlpha\n    | WebGPUConstants.BlendFactor.DstColor\n    | WebGPUConstants.BlendFactor.OneMinusDstColor\n    | WebGPUConstants.BlendFactor.DstAlpha\n    | WebGPUConstants.BlendFactor.OneMinusDstAlpha\n    | WebGPUConstants.BlendFactor.BlendColor\n    | WebGPUConstants.BlendFactor.OneMinusBlendColor\n    | WebGPUConstants.BlendFactor.SrcAlphaSaturated;\n} = {\n  [gl.ZERO]: WebGPUConstants.BlendFactor.Zero,\n  [gl.ONE]: WebGPUConstants.BlendFactor.One,\n  [gl.SRC_COLOR]: WebGPUConstants.BlendFactor.SrcColor,\n  [gl.ONE_MINUS_SRC_COLOR]: WebGPUConstants.BlendFactor.OneMinusSrcColor,\n  [gl.SRC_ALPHA]: WebGPUConstants.BlendFactor.SrcAlpha,\n  [gl.ONE_MINUS_SRC_ALPHA]: WebGPUConstants.BlendFactor.OneMinusSrcAlpha,\n  [gl.DST_COLOR]: WebGPUConstants.BlendFactor.DstColor,\n  [gl.ONE_MINUS_DST_COLOR]: WebGPUConstants.BlendFactor.OneMinusDstColor,\n  [gl.DST_ALPHA]: WebGPUConstants.BlendFactor.DstAlpha,\n  [gl.ONE_MINUS_DST_ALPHA]: WebGPUConstants.BlendFactor.OneMinusDstAlpha,\n  [gl.CONSTANT_COLOR]: WebGPUConstants.BlendFactor.BlendColor,\n  [gl.ONE_MINUS_CONSTANT_COLOR]: WebGPUConstants.BlendFactor.OneMinusBlendColor,\n  // [gl.CONSTANT_ALPHA]: WebGPUConstants.BlendFactor.'constant alpha',\n  // [gl.ONE_MINUS_CONSTANT_ALPHA]: WebGPUConstants.BlendFactor.'one minus constant alpha',\n  [gl.SRC_ALPHA_SATURATE]: WebGPUConstants.BlendFactor.SrcAlphaSaturated,\n};\n\n// @see https://gpuweb.github.io/gpuweb/#texture-formats\nexport const formatMap: {\n  [key: string]:\n    | 'r8unorm'\n    | 'rgba8unorm'\n    | 'depth32float'\n    | 'depth24plus-stencil8';\n} = {\n  [gl.ALPHA]: 'r8unorm',\n  [gl.RGBA]: 'rgba8unorm',\n  [gl.DEPTH_COMPONENT]: 'depth32float',\n  [gl.DEPTH_STENCIL]: 'depth24plus-stencil8',\n};\n\n// @see https://gpuweb.github.io/gpuweb/#enumdef-gpufiltermode\nexport const filterMap: {\n  [key: string]: 'nearest' | 'linear';\n} = {\n  [gl.NEAREST]: 'nearest',\n  [gl.LINEAR]: 'linear',\n};\n\n// @see https://gpuweb.github.io/gpuweb/#enumdef-gpuaddressmode\nexport const wrapModeMap: {\n  [key: string]: 'repeat' | 'clamp-to-edge' | 'mirror-repeat';\n} = {\n  [gl.REPEAT]: 'repeat',\n  [gl.CLAMP_TO_EDGE]: 'clamp-to-edge',\n  [gl.MIRRORED_REPEAT]: 'mirror-repeat',\n};\n\nexport function getCullMode({\n  cull,\n}: Pick<IModelInitializationOptions, 'cull'>):\n  | 'none'\n  | 'front'\n  | 'back'\n  | undefined {\n  if (!cull || !cull.enable) {\n    return WebGPUConstants.CullMode.None;\n  }\n\n  if (cull.face) {\n    return cull.face === gl.FRONT\n      ? WebGPUConstants.CullMode.Front\n      : WebGPUConstants.CullMode.Back;\n  }\n}\n\nexport function getDepthStencilStateDescriptor({\n  depth,\n  stencil,\n}: Pick<IModelInitializationOptions, 'depth' | 'stencil'>):\n  | GPUDepthStencilStateDescriptor\n  | undefined {\n  // TODO: stencil\n\n  const stencilFrontBack: GPUStencilStateFaceDescriptor = {\n    compare: WebGPUConstants.CompareFunction.Always,\n    depthFailOp: WebGPUConstants.StencilOperation.Keep,\n    failOp: WebGPUConstants.StencilOperation.Keep,\n    passOp: WebGPUConstants.StencilOperation.Keep,\n  };\n\n  return {\n    depthWriteEnabled: depth && depth.enable,\n    depthCompare: depthFuncMap[depth?.func || gl.ALWAYS],\n    format: WebGPUConstants.TextureFormat.Depth24PlusStencil8,\n    stencilFront: stencilFrontBack,\n    stencilBack: stencilFrontBack,\n    stencilReadMask: 0xffffffff,\n    stencilWriteMask: 0xffffffff,\n  };\n}\n\n/**\n * @see https://gpuweb.github.io/gpuweb/#color-state\n */\nexport function getColorStateDescriptors(\n  { blend }: Pick<IModelInitializationOptions, 'blend'>,\n  swapChainFormat: GPUTextureFormat,\n): GPUColorStateDescriptor[] {\n  return [\n    {\n      format: swapChainFormat,\n      // https://gpuweb.github.io/gpuweb/#blend-state\n      alphaBlend: {\n        srcFactor:\n          blendFuncMap[(blend && blend.func && blend.func.srcAlpha) || gl.ONE],\n        dstFactor:\n          blendFuncMap[(blend && blend.func && blend.func.dstAlpha) || gl.ZERO],\n        operation:\n          blendEquationMap[\n            (blend && blend.equation && blend.equation.alpha) || gl.FUNC_ADD\n          ],\n      },\n      colorBlend: {\n        srcFactor:\n          blendFuncMap[(blend && blend.func && blend.func.srcRGB) || gl.ONE],\n        dstFactor:\n          blendFuncMap[(blend && blend.func && blend.func.dstRGB) || gl.ZERO],\n        operation:\n          blendEquationMap[\n            (blend && blend.equation && blend.equation.rgb) || gl.FUNC_ADD\n          ],\n      },\n      writeMask: WebGPUConstants.ColorWrite.All,\n    },\n  ];\n}\n"],"file":"constants.js"}