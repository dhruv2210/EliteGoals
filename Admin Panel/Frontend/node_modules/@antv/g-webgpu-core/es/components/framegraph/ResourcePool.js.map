{"version":3,"sources":["../../../src/components/framegraph/ResourcePool.ts"],"names":["inject","injectable","IDENTIFIER","gl","ResourcePool","RenderEngine","resourcePool","resource","name","descriptor","width","height","usage","engine","createFramebuffer","color","createTexture2D","wrapS","CLAMP_TO_EDGE","wrapT"],"mappings":";;;;;;;;AAAA,SAASA,MAAT,EAAiBC,UAAjB,QAAmC,WAAnC;AAEA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,EAAT,QAAmB,gBAAnB;AAKA,WAAaC,YAAb,WADCH,UAAU,EACX,UACGD,MAAM,CAACE,UAAU,CAACG,YAAZ,CADT;AAAA;AAAA;;AAAA;;AAAA,SAKUC,YALV,GAKuD,EALvD;AAAA;;AAAA;AAAA;;AAOE;AACF;AACA;AACA;AAVA,wCAW6BC,QAX7B,EAWoE;AAChE,UAAI,CAAC,KAAKD,YAAL,CAAkBC,QAAQ,CAACC,IAA3B,CAAL,EAAuC;AAAA,mCACJD,QAAQ,CAACE,UADL;AAAA,YAC7BC,KAD6B,wBAC7BA,KAD6B;AAAA,YACtBC,MADsB,wBACtBA,MADsB;AAAA,YACdC,KADc,wBACdA,KADc;AAErC,aAAKN,YAAL,CAAkBC,QAAQ,CAACC,IAA3B,IAAmC,KAAKK,MAAL,CAAYC,iBAAZ,CAA8B;AAC/DC,UAAAA,KAAK,EAAE,KAAKF,MAAL,CAAYG,eAAZ,CAA4B;AACjCN,YAAAA,KAAK,EAALA,KADiC;AAEjCC,YAAAA,MAAM,EAANA,MAFiC;AAGjCM,YAAAA,KAAK,EAAEd,EAAE,CAACe,aAHuB;AAIjCC,YAAAA,KAAK,EAAEhB,EAAE,CAACe,aAJuB;AAKjCN,YAAAA,KAAK,EAALA;AALiC,WAA5B;AADwD,SAA9B,CAAnC;AASD;;AAED,aAAO,KAAKN,YAAL,CAAkBC,QAAQ,CAACC,IAA3B,CAAP;AACD;AA1BH;AAAA;AAAA,4BA4BiB;AACb,WAAKF,YAAL,GAAoB,EAApB;AACD;AA9BH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import { inject, injectable } from 'inversify';\nimport { IFramebuffer } from '../..';\nimport { IDENTIFIER } from '../../identifier';\nimport { gl } from '../renderer/gl';\nimport { IRendererService } from '../renderer/IRendererService';\nimport { ResourceEntry } from './ResourceEntry';\n\n@injectable()\nexport class ResourcePool {\n  @inject(IDENTIFIER.RenderEngine)\n  private readonly engine: IRendererService;\n\n  // 资源池\n  private resourcePool: Record<string, IFramebuffer> = {};\n\n  /**\n   * 负责实例化虚拟资源，通过引擎服务\n   * @param resource 虚拟资源\n   */\n  public getOrCreateResource(resource: ResourceEntry): IFramebuffer {\n    if (!this.resourcePool[resource.name]) {\n      const { width, height, usage } = resource.descriptor;\n      this.resourcePool[resource.name] = this.engine.createFramebuffer({\n        color: this.engine.createTexture2D({\n          width,\n          height,\n          wrapS: gl.CLAMP_TO_EDGE,\n          wrapT: gl.CLAMP_TO_EDGE,\n          usage,\n        }),\n      });\n    }\n\n    return this.resourcePool[resource.name];\n  }\n\n  public clean() {\n    this.resourcePool = {};\n  }\n}\n"],"file":"ResourcePool.js"}